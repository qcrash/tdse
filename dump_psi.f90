subroutine dump_psi(n, h, i_unit, psi)
!------------------------------------------------------------------------------
! Description: 
!------------------------------------------------------------------------------
! dump psi on unit i unit.
!------------------------------------------------------------------------------
  implicit none
!------------------------------------------------------------------------------
! Modules and Global Variables
!------------------------------------------------------------------------------

!------------------------------------------------------------------------------
! External Functions
!------------------------------------------------------------------------------

!------------------------------------------------------------------------------
! Input Parameters
!------------------------------------------------------------------------------
  integer, intent(in) :: n, i_unit
  double complex, intent(in) :: psi(n)
  double precision, intent(in) :: h
!------------------------------------------------------------------------------
! Output Parameters
!------------------------------------------------------------------------------

!------------------------------------------------------------------------------
! Input/Output Parameters
!------------------------------------------------------------------------------

!------------------------------------------------------------------------------
!  Local Variables
!------------------------------------------------------------------------------
  integer :: igrid
  double precision :: tmp1, tmp2
!------------------------------------------------------------------------------
!  Local Constants 
!------------------------------------------------------------------------------
  ! second derivative loop
  do igrid = 1, n
     tmp1 = real(psi(igrid))
     tmp2 = aimag(psi(igrid))
     if (abs(tmp1) < 1d-10) tmp1 = 0d0
     if (abs(tmp2) < 1d-10) tmp2 = 0d0
     write(i_unit,"(f16.10,2(2x, g24.17))") (h*dble(igrid) - 1d0),&
          & tmp1, tmp2
  end do
end subroutine dump_psi
